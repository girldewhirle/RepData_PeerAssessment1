---
title: 'Reproducible Research: Peer Assessment 1'
output:
  html_document:
    keep_md: yes
  pdf_document: default
---


## Loading and preprocessing the data

```{r, echo=TRUE}

## load libraries
library("plyr")
library("dplyr")
library("tidyr")
library("lubridate")
library("knitr")

## download data to working directory
download.file("https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip","ProjectOne",method="curl")

## unzip data
unzip("ProjectOne")

## read in file including headers
activity<-read.csv("activity.csv",header=TRUE)

## convert dates to useful format
activity$date<-ymd(activity$date)
```



## What is mean total number of steps taken per day?

```{r, echo=TRUE}
## group by date
grouped_activities<-tbl_df(activity)
grouped_activities<-group_by(grouped_activities,date)
## sum steps by date and write to new variable. NB: NA's are removed when calling sum function
total_steps<-summarise(grouped_activities,sum(steps,na.rm=TRUE))

```

```{r,echo=TRUE}
hist(total_steps$sum,main="Histogram of Total Steps (data grouped by day)",xlab="Total Steps by Day")

```

```{r,echo=TRUE}
## calculate mean total steps
mean_total_steps<-mean(total_steps$sum,na.rm=TRUE)
## print mean total steps
print("Mean Total Steps")
mean_total_steps
## calculate median total steps
med_total_steps<-median(total_steps$sum,na.rm=TRUE)
## print median total steps
print("Median Total Steps")
med_total_steps

```



## What is the average daily activity pattern?
```{r,echo=TRUE}
## group by intervals
intervals<-group_by(activity,interval)
## mean steps by day in a new variable (NA's ignored)
steps_by_day<-summarise(intervals,mean(steps,na.rm=TRUE))
## rename column name
colnames(steps_by_day)[2]<-"Mean_Steps"
## plot average no. steps
plot(steps_by_day$interval,steps_by_day$Mean_Steps, type="l", ylab="Mean Steps per Interval (across all day)",xlab="Interval (5 min period across day)",main="Average Number of Steps at 5 Minute Intervals")
```

Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r,echo=TRUE}
## calculate max from the steps_by_day table
max_steps<-max(steps_by_day$Mean_Steps)
## filter table based on max for output
max_interval<-filter(steps_by_day,Mean_Steps==max_steps)
## print value
print(as.numeric(max_out<-max_interval[1,1]))
```



## Imputing missing values

Total number of rows with NAs in dataset:

```{r,echo=TRUE}
## calculate complete cases
complete_cases<-complete.cases(activity)
## print out number of rows that aren't complete cases
print(as.data.frame(table(complete_cases))[1,2])
```




## Are there differences in activity patterns between weekdays and weekends?
